# OPM Notifications Example Configuration
# Copy this file to ~/.opm/config.toml and adjust the [daemon.notifications] section

# This is an example of how to configure notifications in OPM.
# Add this section to your ~/.opm/config.toml file.

[daemon.notifications]
# Master switch for all notifications
enabled = true

# Configure which events trigger notifications
[daemon.notifications.events]
agent_connect = true       # Notify when an agent connects
agent_disconnect = true    # Notify when an agent disconnects
process_start = true       # Notify when a process starts
process_stop = true        # Notify when a process stops
process_crash = true       # Notify when a process crashes
process_restart = true     # Notify when a process restarts

# ========================================
# NEW FORMAT (Recommended - Easier to configure)
# ========================================
# Use structured channel configurations with clear field names

# Discord Example
[[daemon.notifications.channel]]
type = "discord"
webhook_url = "https://discord.com/api/webhooks/YOUR_WEBHOOK_ID/YOUR_WEBHOOK_TOKEN"

# Slack Example
[[daemon.notifications.channel]]
type = "slack"
webhook_url = "https://hooks.slack.com/services/YOUR/WEBHOOK/URL"

# Telegram Example - USE NUMERIC CHAT ID (NOT @username)
[[daemon.notifications.channel]]
type = "telegram"
bot_token = "123456:ABCdefGHIjklMNOpqrsTUVwxyz"
chat_id = "-1001234567890"  # Negative number for channels/groups, positive for users
# To get chat_id:
# 1. Add bot to your channel/group (make it admin for channels)
# 2. Send a test message
# 3. Visit: https://api.telegram.org/bot<BOT_TOKEN>/getUpdates
# 4. Find "chat":{"id": -1001234567890 } in JSON response

# Gotify Example
[[daemon.notifications.channel]]
type = "gotify"
server_url = "https://gotify.example.com"
token = "YOUR_APP_TOKEN"
priority = 5  # 0-10, default is 5

# Pushover Example
[[daemon.notifications.channel]]
type = "pushover"
token = "YOUR_APP_TOKEN"
user_key = "YOUR_USER_KEY"
# device = "iphone"  # Optional: target specific device

# Matrix Example
[[daemon.notifications.channel]]
type = "matrix"
homeserver = "https://matrix.example.com"
room_id = "!roomid:example.com"
access_token = "YOUR_ACCESS_TOKEN"

# Ntfy Example (ntfy.sh or self-hosted)
[[daemon.notifications.channel]]
type = "ntfy"
server_url = "https://ntfy.sh"  # or your server
topic = "your-topic-name"
# token = "tk_xxxxx"  # Optional: for authentication

# Mattermost Example
[[daemon.notifications.channel]]
type = "mattermost"
webhook_url = "https://mattermost.example.com/hooks/YOUR_WEBHOOK_ID"
# channel = "off-topic"  # Optional: override webhook default
# username = "OPM Bot"   # Optional: override webhook default

# Generic Webhook Example (sends POST with JSON: {title, message})
[[daemon.notifications.channel]]
type = "webhook"
url = "https://your-server.com/webhook/endpoint"
# Optional headers for authentication
# [daemon.notifications.channel.headers]
# "Authorization" = "Bearer YOUR_TOKEN"
# "X-Custom-Header" = "custom-value"

# ========================================
# LEGACY FORMAT (Still supported for backward compatibility)
# ========================================
# Old Shoutrrr-style URL format - harder to configure but still works
# channels = [
#     "discord://token@id",
#     "slack://token:token@channel",
#     "telegram://BOT_TOKEN@telegram?chats=-1001234567890",
#     "gotify://gotify.example.com/token",
#     "pushover://shoutrrr:token@user",
#     "matrix://user:password@homeserver/?rooms=!room",
# ]

# ========================================
# Complete Example Configuration
# ========================================
#
# [daemon.notifications]
# enabled = true
# 
# [daemon.notifications.events]
# agent_connect = true
# agent_disconnect = true
# process_start = false
# process_stop = false
# process_crash = true
# process_restart = true
# 
# [[daemon.notifications.channel]]
# type = "discord"
# webhook_url = "https://discord.com/api/webhooks/123/abc"
# 
# [[daemon.notifications.channel]]
# type = "telegram"
# bot_token = "123456:ABCdef"
# chat_id = "-1001234567890"
